<link rel="stylesheet" href="@App.Path/assets/styles.css" data-enableoptimizations="bottom" /> 
@{
    var currentPath = Request.RawUrl.ToLower();
    var pageLinks = AsDynamic(Data["Links"]).Where( x => x.Link.ToLower().Equals(currentPath));
    var showLinks = pageLinks.Where(x => x.Show == true);
    var Lib = CreateInstance("_library.cshtml");
    var newKey = Lib.GenerateCode( Content.Prefix , (int)App.Settings.GenerateKeyLength, true);
}
@* public part *@

@foreach(var link in showLinks) {
    var domainAndKey = App.Settings.ShortDomain + "/" + link.Key;
    var full = App.Settings.Protocol + domainAndKey;
   <div class="container-fluid">
       <div class="ly-container-inner">
            <div class="row row-centered" style="margin-top:22px;margin-bottom:57px;">
                <div class="col-xs-4 col-sm-3 col-centered">
                    <a href="@full.Replace("http:","https:")" target="_blank" style="float:right;">
                        <img src="@Lib.QrLink(full)" width="80"><br>
                        <span style="font-size: small;">@domainAndKey</span>
                    </a>
                </div>
                <div class="col-xs-8 col-sm-4  col-centered">
                   <h3 style="color:#333; margin-top:0;">weiterempfehlen mit<br>
                    diesem Kurz-Link / QR-Code:<br></h3>
                    <h3 style="margin:10px 0 20px 0;font-size:18px;">
                        <a href="@full.Replace("http:","https:")" target="_blank">
                            @domainAndKey
                        </a>
                    </h3>
                    <a href="/catalog/product/kurz-links-und-perfekte-qr-codes" target="_blank" class="btn btn-primary co-button">mehr Ã¼ber Kurz-Links erfahren</a>
                 </div> 
            </div>
        </div> 
    </div>
    <span id="linkkey" style="display:none;">@domainAndKey</span>
}


@* admin part *@
@if(Permissions.UserMayEditContent){
        <div class="container-fluid app-shortlinks-wrapper">
            <div class="ly-container-inner">
                <div class="row">
                    <div class="col-xs-12 sc-element">
                        @*Edit.Toolbar(Content)*@

                        @RenderPage("_Table Fragment.cshtml", new { links = pageLinks })
                    </div>
                    <div class="col-xs-12">
                        
                        @Edit.Toolbar(actions: "new", contentType: "Link", prefill: new { Key = newKey, Link = Request.RawUrl }) for @newKey
                    </div>
                </div>
            </div>
        </div>              
}



